\documentclass[handout,11pt]{beamer}
%\documentclass[slides]{beamer}

%\usetheme{Warsaw}
\usetheme{Montpellier}
\usefonttheme[onlymath]{serif}
\setbeamertemplate{headline}{}
\setbeamertemplate{navigation symbols}{}

%\usepackage[english,norsk,german]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{proof}
\usepackage{url}
\usepackage{verbatim}
\usepackage{hyperref}
\usepackage{graphics}

\usepackage{color}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\green}[1]{\textcolor{green}{#1}}

%\usepackage[all]{xy}
\usepackage{amssymb,amsmath}
%\usepackage{stmaryrd}

\newtheorem{proposition}{Proposition}

\newcommand{\weg}[1]{}
\newcommand{\Prop}{\mathit{Prop}}
\newcommand{\nat}{\mathbb{N}}
\newcommand{\set}[1]{\{#1\}}
\newcommand{\liff}{\leftrightarrow}
\newcommand{\proves}{\vdash}
\newcommand{\forces}{\mathrel{\Vdash}}
\newcommand{\deca}{${\lor}{\exists}{\land}$}

\newcommand{\XX}{\mbox{\sf X}}
\newcommand{\ndE}{\vdash_{\es}}
\newcommand{\ndX}{\vdash_{X}}
\newcommand{\ndxx}{\vdash_{\vec x}}
\newcommand{\ndY}{\vdash_{Y}}
\newcommand{\ndXx}{\vdash_{X,x}}
\newcommand{\ndXxi}{\vdash_{X,\vec x_i}}
\newcommand{\es}{\emptyset}

\newcommand{\covd}{\mathrel{\vartriangleleft}}
\newcommand{\covs}{\mathrel{\vartriangleright}}
\newcommand{\covT}{\mathrel{\vartriangleleft_T}}

\newcommand*{\C}{{\mathbb{C}}}
\newcommand*{\D}{{\mathbb{D}}}
\newcommand*{\E}{{\mathcal{E}}}
\newcommand*{\subvs}{_{\mathrm{vs}}}
\newcommand*{\subrn}{_{\mathrm{rn}}}
\newcommand*{\subts}{_{\mathrm{ts}}}

\newcommand{\Cvs}{\mathbb{C}\subvs}
\newcommand{\Crn}{\mathbb{C}\subrn}
\newcommand{\Cts}{\mathbb{C}\subts}
\newcommand{\Tvs}{T\subvs}
\newcommand{\Trn}{T\subrn}
\newcommand{\Tts}{T\subts}
\newcommand{\Fts}{\Vdash\subts}
\newcommand{\Fvs}{\Vdash\subvs}
\newcommand{\Frn}{\Vdash\subrn}
\newcommand{\FTvs}{\Vdash^T\subvs}
\newcommand{\FTrn}{\Vdash^T\subrn}
\newcommand{\stdcat}[1]{\textup{\bfseries #1}}
%\newcommand{\blank}{\textup{--}}
\newcommand{\blank}{\mathord{\operatorname{-}}} %{\color{lightgray}-}}


\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ConFilt}{ConFilt}
\DeclareMathOperator{\Sh}{Sh}
\DeclareMathOperator{\Psh}{PSh}
\DeclareMathOperator{\Ob}{Ob}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\cod}{cod}
\DeclareMathOperator{\Tm}{Tm}
\DeclareMathOperator{\Fact}{Fact}
\DeclareMathOperator{\Ima}{Im}
\DeclareMathOperator{\NV}{NV}



\title{Syntactic Forcing Models for Coherent Logic}
\author{Marc Bezem\\
Department of Informatics\\
University of Bergen\\
\mbox{ }\\
(based on jww U. Buchholtz and T. Coquand, 2018,\\
{\tt arxiv.org/abs/1712.07743})
}
\date{September 2022}

\begin{document}

\frame{\titlepage}

\section[Outline]{}
\frame{\tableofcontents}


\section{A category of forcing conditions}

\section{Conditions as a category}

\begin{frame}
\frametitle{Categories of forcing conditions}
 \begin{itemize}[<+->]   %  [<+-| alert@+>]
   \item Fix a finite first-order signature $\Sigma$
   \item Fix a countably infinite set of variables $\XX=\set{x_0,x_1,\ldots}$
   \item Let $\Tm(X)$ be the set of $\Sigma$-terms over $X \subseteq \XX$    
   \item Define the category $\Cts$ having:
    \begin{itemize}[<+->]   %  [<+-| alert@+>]
    \item Objects denoted as pairs $(X;A)$,
    where $X$ is a finite subset of $\XX$ and $A$ is a finite set
    of atoms in the language defined by $\Sigma$ and $X$.
    (This means that only variables from $X$ may occur in $A$.)
    Such pairs $(X;A)$ are called \emph{conditions}.
    \item Morphisms denoted as $f : (Y;B) \to (X;A)$, where $f$ is a 
    \emph{term substitution} $X \to \Tm(Y)$ such that $Af \subseteq B$
    \item Composition $f\circ g$ of $g : (Z;C) \to (Y;B)$ with $f$ above is
    the substitution $X \to \Tm(Z)$ that is the composition $fg$
    (in diagram order!) of the respective substitutions
    \item Indentity morphisms $(X;A)\to(X;A)$ are identity 
    substitutions $X\to X$
    \end{itemize}
    \item Similarly to $\Cts$, define $\Cvs~(\Crn)$ when 
    in addition $f(X)\subseteq Y$ (and also $f$ injective)
 \end{itemize}
\end{frame}


\begin{frame}
\frametitle{Categories of forcing conditions (ctnd)}
 \begin{itemize}[<+->]   %  [<+-| alert@+>]
    \item $\Cts,\Cvs,\Crn$ are indeed categories with terminal object $(;)$
    \item Conditions will be denoted as, e.g., $(x,y,z;p(z),q(f(x),z,z))$
    \item Substitutions will be denoted as, e.g., $[y:=x,z:=g(x)]$
    \item Post-fixing substitutions in diagram order: $(Af)g = A(fg)$
    \item Depending on $\Sigma$, categories
    $\Cts,\Cvs,\Crn$ are rather different:
     \begin{itemize}
      \item $[x:=0],[x:=1]:(;)\rightrightarrows(x;)$ cannot be equalized
      \item $[x:=y],[x:=z]:(y,z;)\rightrightarrows(x;)$ can be equalized    
      by $[y:=w,z:=w]:(w;)\to(y,z;)$ in $\Cvs$, but not in $\Crn$
     \end{itemize}
    \item Actually, $\Cts~(\Cvs)$ has all finite products (limits) 
    \item Depending on $\Sigma$, categories $\Cts,\Cvs,\Crn$ will 
    lead to different forcing semantics 
    (good for independence proofs!)
    \item What does a condition mean? A finite, partial description
    of potential models. Time to consider a coherent theory $T$ ...       
 \end{itemize}
\end{frame}

\section{Coverages}

\begin{frame}
\frametitle{Coverages depending on coherent theories}
 \begin{itemize}[<+->]   %  [<+-| alert@+>]
  \item Fix a coherent theory $T$
  \item Define inductively a relation $\covT$ between
  conditions and finite sets of conditions (denoted by $U,V,...$):    
   \begin{enumerate}
    \item[(base)] $C\covT\set{C}$ for all conditions $C$
    \item[(step)] If $T$ has an axiom $\forall\vec{x}.~
    (C \to (\exists\vec{y}_1.B_1) \lor \cdots \lor (\exists\vec{y}_n.B_n))$
    such that for some sequence of terms $\vec{t}$ with variables in $X$
    we have $C[\vec{t}/\vec{x}] \subseteq A$, then the following rule applies:   
\[
\frac{(X,\vec y_1; A,B_i[\vec{t}/\vec{x}]) \covT U_1 \quad \ldots
\quad (X,\vec y_n; A,B_i[\vec{t}/\vec{x}]) \covT U_n}
{(X;A) \covT \bigcup_{1\leq i\leq n} U_i}
\]
   \end{enumerate}
  \item Looks familiar? Let's take the semantic point of view.
  \item Example: if $T=\set{p\to(q\lor r)}$, 
  then $(;p)\covT\set{(;p,q),(;p,r)}$. The models of $T$ extending $(;p)$ are
  models extending $(;p,q)$ or models extending $(;p,r)$
  \item Borderline case: if $T=\set{p\to \bot}$, then $(;p)\covT\es$
  \item When $C \covd U$ (drop ${}_T$, also: $U \covs C$) 
  we say that $U$ covers $C$ 
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Structural properties of the coverage}
 \begin{itemize}[<+->]   %  [<+-| alert@+>]
    \item The properties of $\covd$ use (any one of) $\Cts,\Cvs,\Crn$
    %\item We drop $T$ from the notation $\covT$
    \item Lemma ${\covd}1$. If $(X;A) \covd U$ and $(Y;B)\in U$,
    then $X\subseteq Y$ and $A\subseteq B$ and $i_{X,Y} : (Y;B)\to(X;A)$.
    Prf: easy induction on $\covd$.
    \item Lemma ${\covd}2$. If $f:D\to C$ and $C\covd U$, then there is
    $V\covs D$ such that, for any $E\in V$ there is an $F\in U$ such 
    that $g:E\to F$ with $g$ an extension of $f$.
    Proof: induction on $\covd$. Intuition: view $D$ as an (extension of) the
    $f$-instance of $C$. \red{NB $\Crn$ OK!}
    \item Lemma ${\covd}3$. If $C \covd U$ and for every $D\in U$
    we have a $V_D \covs D$, then $C\covd\bigcup_{D\in U} V_D$.
    Proof: induction on $\covd$. Intuition: transitivity.
    \item Together with ${\covd}0:~C \covd\set{C}$, ${\covd}$0--${\covd}$3
    provide what is needed for the coming definition of forcing to
    give a sound and complete semantics.
    \item Further abstraction $\rightsquigarrow$ Grothendieck topology and site
    
 \end{itemize}
\end{frame}

\section{Forcing}

\begin{frame}
\frametitle{Forcing relation based on coverage}

Let ${\covd}$ be a coverage. % as in Definition~\ref{def:covering}.
For any condition $C=(X;A)$ and any first-order formula
$\phi$ with free variables in $X$, we define the forcing relation
$C\Vdash\phi$ by induction on $\phi$ as follows:
\begin{enumerate}
\item $C\Vdash\top$

\item $C\Vdash\bot$ if $C\covd\es$ (i.e., $A\vdash_X \bot$, explain)

\item $C\Vdash\phi$ if $\phi$ is an atom and there is $U \covs C$ such that
$\phi\in B$ for all $(Y;B)\in U$ (i.e., $A\vdash_X \phi$)

\item $C\Vdash\phi_1 \land \phi_2$ if $C\Vdash\phi_1$ and $C\Vdash\phi_2$

\item $C\Vdash\phi_1 \lor \phi_2$ if for some $U$ we have
$C\covd U$ and ($D\Vdash\phi_1$ or $D\Vdash\phi_2$) for all $D\in U$

\item $C\Vdash\phi_1 \to \phi_2$ if for all $D$ and morphisms $f:D\to C$
we have $D\Vdash\phi_2f$ whenever $D\Vdash\phi_1f$

\item $C\Vdash\forall x.\phi$ if for all $D=(Y;B)$ and 
morphisms $f:D\to C$ we have 
 $D\Vdash\phi [f,x=t]$ for all $t\in\Tm(Y)$
 
\item $C\Vdash\exists x.\phi$ if there is $U\covs C$ such that,
for all $D\in U$, $D=(Y;B)$, $D\Vdash\phi[x=t]$ for some $t\in\Tm(Y)$

\end{enumerate}
\end{frame}

\subsection{Examples}

\begin{frame}
\frametitle{Examples}
 \begin{itemize}[<+->]
    \item The law of the excluded middle is not forced:
    for $\Sigma=\set{p},~T=\es$, \red{not} $(;)\Vdash p\lor\neg p$
    \item Unlike Kripke semantics, there is no one-world frame. Hence
    for $\Sigma=\set{p},~T=\es$, surprisingly, $(;)\Vdash \neg\neg p$
    \item Classical contingencies can sometimes be forced:
    for $\Sigma=\set{P(\blank)},~T=\es$, \red{never} $C\Vdash \forall x. P(x)$,
    so $(;)\Vdash (\forall x. P(x))\to\bot$
    \item Distinguishing $\Fvs$ and $\Fts$: if $\Sigma=\set{Z(\blank),0}$ and
    \begin{itemize}[<+->]
     \item $T=\set{\neg Z(0)}$, then $(x;)\Fvs\neg\neg Z(x)$,
     % assume C->(x;), if Z0 in C, then empty cover, else not C\Fvs\negZx
     % and we can extend C with Zx to D without empty cover
     and \red{not} $(x;)\Fts\neg\neg Z(x)$ (since Â $[x:=0] : (;)\to(x;)$,
     $(;)\Fts \neg Z(0)$ and \red{not} $(;)\Fts \bot$)
     \item Better, add $\exists x.\top$ to $T$ and get for
     $\phi= \exists x.\neg\neg Z(x)$ that $(;)\Fvs \phi$ 
     % (;) covered by {(x;)}, take t=x and use $(x;)\Fvs\neg\neg Z(x)$    
     and \red{not} $(;)\Fts\phi$.
     % (;) <| {(x,...;)} and neither (;)\Fts\neg\neg Z(0),  
     % nor (x;)\Fts\neg\neg Z(0), nor (x;)\Fts\neg\neg Z(x) 
    \end{itemize}
    \item NB $T\vdash\exists x.\top$ and yet it makes a difference
    \item Distinguishing $\Frn$ from $\Fvs,\Fts$ is done in [BBC, 6.4]
    by a rather complicated example (with relational $\Sigma$)
    %For $\Sigma=\set{P(\blank),Q(\blank,\blank),R(\blank,\blank)}$, 
    %$T=\set{\forall x,z.~P(x)\to(Q(x,z)\lor R(x,z))}$, and
    %$\phi= \forall x,y.~(P(x)\land P(y)\land\neg\forall z.(Q(x,z)\lor R(x,z)))$,
    %we have $(;)\Fvs \neg\phi$ and $(;)\Frn \neg\neg\phi$ 
 \end{itemize}
\end{frame}

\section{Soundness}

\begin{frame}
\frametitle{Special soundness: forcing the theory itself}
\begin{itemize}[<+->]
 \item Fix a coherent theory $T$ with its $\covd$ and $\Vdash$    
 \item For all $\phi\in T$ we have $(;)\Vdash\phi$
 \item Proof by example: take
 $\phi\equiv\forall x.~(P(x)\to (p\lor \exists y. Q(x,y)))$.
 (TL;DR) Note that $(;)$ is final, so we have to show that 
 $C\Vdash P(t)\to p\lor \exists y. Q(t,y)$ for all
 conditions $C=(X;A)$ and $t\in\Tm(X)$. So, we have to show
 that $D\Vdash (p\lor \exists y. Q(tf,y))$ for all $D=(Y;B)$
 and $f:D\to C$ with $D\Vdash P(tf)$. Now, if $U\covs D$ such 
 that every $E\in U$ contains $P(tf)$, then we can use
 the instance of $\phi$ with $tf$ to cover $E$
 such that $E\Vdash p\lor \exists y. Q(tf,y)$,
 and use ${\covd}3$ to get $D\Vdash p\lor \exists y. Q(tf,y)$.
 \item By the general soundness result (next slide),
 not only $T$ is forced, but also all its intuitionistic,
 possibly non-coherent consequences.
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{General soundness of the forcing semantics}
\begin{itemize}[<+->]
 \item Fix a signature $\Sigma$, one of the categories $\Cts,\Cvs,\Crn$, 
 a coverage $\covd$ with its forcing relation by $\Vdash$
 \item \red{No} coherent theory $T$ is assumed here
 \item Let $\Gamma\vdash_X^i \phi$ denote intuitionistic 
 provability (explain $X$) 
 \item Soundness: for \red{all} formulas $\Gamma,\phi$ 
 with free variables in $X$, if $\Gamma\vdash_X^i \phi$, then for any $C$
 and $\rho: X\to\Tm(C)$, 
 $$C\Vdash \Gamma\rho~\text{implies}~C\Vdash \phi\rho$$
 \item Proof: induction on $\Gamma\vdash_X^i \phi$ (long and tedious)
 \end{itemize}
\end{frame}

\section{Completeness}

\begin{frame}
\frametitle{Completeness for coherent formulas}
 \begin{itemize}[<+->]
  \item Fix a coherent theory $T$ with its $\covd$ and $\Vdash$
  \item Coherent completeness: for every \red{coherent} sentence
  $\phi$, if $(,)\Vdash\phi$, then $T\vdash_{\es}^i \phi$
  \item For the proof we need a version 
  for open formulas 
  \item Completeness: for every \red{coherent} sentence
  $\phi$ with free variables in $X$, any condition $C=(Y;A)$
  and $\rho: X\to\Tm(Y)$,
  $$C\Vdash \phi\rho~\text{implies}~T,A\vdash_X^i \phi\rho$$
  \item Proof by induction on $\phi$
  \item This proof is constructive, and doesn't use `fairness'
  \item On the other hand, there is syntax in this semantics
 \end{itemize}
\end{frame}

\subsection{Redundant sentences}

\begin{frame}
\frametitle{Redundant sentences}
 \begin{itemize}[<+->]
  \item Let $T$ be a coherent theory. A sentence $\phi$ is called
  $T$- \emph{redundant} if all coherent sentences $\psi$ such that 
  $T,\phi \vdash^i \psi$ can be proved already in $T$
  \item The combination of soundness with coherent completeness
  yields that $\phi$ is redundant if $\phi$ is forced:
  if $T\vdash^i \phi\to\psi$, then by soundness $\phi\to\psi$ is forced.
  Hence if $\phi$ is forced, then also $\psi$ is forced, 
  and hence provable in $T$ if coherent.
  \item Example (Kock): in the theory of local rings, the following
  formula is forced and hence redundant (suprise?)
  $$\neg(x=0\land y=0) \to (\exists z.xz=1) \lor (\exists z.yz=1)$$
 \end{itemize}
\end{frame}

%local ring: every sum that is a unit has a term that is a unit
\end{document}

\begin{frame}
\frametitle{Title}
 \begin{itemize}[<+->]
    \item 
 \end{itemize}
\end{frame}


Th{\'e}ories coh{\'e}rentes et topos coh{\'e}rents,
    M.-F.~Coste and M.~Coste, 1975.
